<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"/>




  <link href="//fonts.googleapis.com/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">



<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=0.5.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=0.5.0" />






<meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="zhenby's blog">
<meta property="og:url" content="http://zhenby.com/index.html">
<meta property="og:site_name" content="zhenby's blog">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="zhenby's blog">
<meta name="twitter:description">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"left","display":"hide"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>

  <title> zhenby's blog </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-32727809-1', 'auto');
  ga('send', 'pageview');
</script>







  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">zhenby's blog</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu ">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-home fa-fw"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-archive fa-fw"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-iread">
          <a href="/iread" rel="section">
            
              <i class="menu-item-icon fa fa-question-circle fa-fw"></i> <br />
            
            我读
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-user fa-fw"></i> <br />
            
            关于
          </a>
        </li>
      

      
      
      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">

    

    
    
      
      
        
        
        
      

      
    

    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/blog/2016/04/29/FBRetainCycleDetector-Learning-1/" itemprop="url">
                  FBRetainCycleDetector解析——获取一般对象的强引用对象
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-04-29T14:29:25+08:00" content="2016-04-29">
              2016-04-29
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/编程技术/" itemprop="url" rel="index">
                    <span itemprop="name">编程技术</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/blog/2016/04/29/FBRetainCycleDetector-Learning-1/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="/blog/2016/04/29/FBRetainCycleDetector-Learning-1/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Facebook 前不久发布三个工具用于检测内存泄露，分别是 <a href="https://github.com/facebook/FBRetainCycleDetector" target="_blank" rel="external">FBRetainCycleDetector</a>、<a href="https://github.com/facebook/FBAllocationTracker" target="_blank" rel="external">FBAllocationTracker</a> 及 <a href="https://github.com/facebook/FBMemoryProfiler" target="_blank" rel="external">FBMemoryProfiler</a>，并在他们的技术博客上发布了一篇相关的博客 <a href="https://code.facebook.com/posts/583946315094347/automatic-memory-leak-detection-on-ios/" target="_blank" rel="external">Automatic memory leak detection on iOS</a>。</p>
<p>看了一下 FBRetainCycleDetector 的代码，通过 Runtime 捕获循环引用，原理在 <a href="https://code.facebook.com/posts/583946315094347/automatic-memory-leak-detection-on-ios/" target="_blank" rel="external">Automatic memory leak detection on iOS</a> 这篇博客中有说到：把对象（包括 Block 对象）当成节点，以强引用为关系建立有向图，以深度优先遍历该有向图，寻找有向图中的环，一个环就代表一个循环引用。</p>
<p>本篇博客介绍 FBRetainCycleDetector 库中获取一般对象的强应用对象的原理。</p>
<h2 id="Runtime-中的相关函数"><a href="#Runtime-中的相关函数" class="headerlink" title="Runtime 中的相关函数"></a>Runtime 中的相关函数</h2><p>先介绍一下 Runtime 中的几个函数：</p>
<ul>
<li><code>Class object_getClass(id obj)</code>：获取一个对象所属的类；</li>
<li><code>Class class_getSuperclass(Class cls)</code>：获取一个类的父类；</li>
<li><code>Ivar *class_copyIvarList(Class cls, unsigned int *outCount)</code>：获取某个类中的成员变量个数及成员变量数组，但是不包含父类的；</li>
<li><code>ptrdiff_t ivar_getOffset(Ivar v)</code>：获取成员变量中的偏移位置，关于成员变量偏移位置的解析，可以看这篇博客<a href="http://quotation.github.io/objc/2015/05/21/objc-runtime-ivar-access.html" target="_blank" rel="external">Objective-C类成员变量深度剖析</a>；</li>
<li><code>const uint8_t *class_getIvarLayout(Class cls)</code>：获取某个类中 Strong 类型的成员变量的布局，关于 Ivar Layout 下面会展开说明一下。</li>
</ul>
<h2 id="Ivar-Layout"><a href="#Ivar-Layout" class="headerlink" title="Ivar Layout"></a>Ivar Layout</h2><p><code>const uint8_t *class_getIvarLayout(Class cls)</code> 函数中有一个 Ivar Layout 的概念，表示成员变量的布局情况。</p>
<p>相对于 Strong 类型的成员变量，函数 <code>const uint8_t *class_getWeakIvarLayout(Class cls)</code> 可以获取 Weak 类型的成员变量的布局情况。</p>
<p>例子如下：</p>
<figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ClassA</span> : <span class="title">NSObject</span></span></span><br><span class="line">&#123;</span><br><span class="line">    __unsafe_unretained <span class="keyword">id</span> ivar0;</span><br><span class="line">    __<span class="keyword">weak</span> <span class="keyword">id</span> ivar1;</span><br><span class="line">    __<span class="keyword">strong</span> <span class="keyword">id</span> ivar2;</span><br><span class="line">    __<span class="keyword">weak</span> <span class="keyword">id</span> ivar3;</span><br><span class="line">    __<span class="keyword">strong</span> <span class="keyword">id</span> ivar4;</span><br><span class="line">    __<span class="keyword">strong</span> <span class="keyword">id</span> ivar5;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p><code>const uint8_t *class_getIvarLayout(Class cls)</code> 函数获取到的是一个 uint8_t 的数组，一个 uint8_t 在 16 进制下是两位，所以编码的值每两位一对。这两位中，前面一位表示有多少个非 Strong 类型的成员变量，后面一位表示接下来有多少个 Strong 类型的成员变量，而这个顺序是根据成员变量声明的顺序决定的，此顺序也跟函数 <code>Ivar *class_copyIvarList(Class cls, unsigned int *outCount)</code> 获取到的一致。</p>
<p>在这个例子中，ClassA 类的 IvarLayout 的值为 <code>0x211200</code>：</p>
<ul>
<li><code>0x211200</code> 中的 <code>21</code> 中的 <code>2</code> 就代表一开始有两个非 Strong 类型的成员变量（ivar0 及 ivar1），其中的 <code>1</code> 则代表接下来有一个 Strong 类型的成员变量（ivar2）；</li>
<li>接下来的 <code>12</code> 中的 <code>1</code> 代表接下来有一个 非 Strong 类型的成员变量（ivar3），其中的 <code>2</code> 则代表接下来有两个 Strong 类型的成员变量（ivar4 及 ivar5）；</li>
<li>最后的 <code>00</code> 为结束符。</li>
</ul>
<p>同理我们可以推测出 ClassA 类的 WeakIvarLayout 的值为：<code>0x111100</code>。</p>
<p>本段重点参考资料：<a href="http://blog.sunnyxx.com/2015/09/13/class-ivar-layout/" target="_blank" rel="external">Objective-C Class Ivar Layout 探索</a> </p>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><p>基于上面介绍的几个函数，串连起来就可以实现获取一般对象的强引用对象的功能了，代码如下：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">@ (NSArray&lt;NSValue *&gt; *)strongIvarsWithObject:(id)object</span><br><span class="line">&#123;</span><br><span class="line">    NSMutableArray&lt;NSValue *&gt; *strongIvars = [NSMutableArray new];</span><br><span class="line">    </span><br><span class="line">    __unsafe_unretained Class previousClass = nil;</span><br><span class="line">    __unsafe_unretained Class currentClass = object_getClass(object);</span><br><span class="line">    </span><br><span class="line">    // 往上一直获取父类，直到 NSObject</span><br><span class="line">    while (previousClass != currentClass) &#123;</span><br><span class="line">        // 获取当前类的 Strong 成员变量布局</span><br><span class="line">        const uint8_t * ivarLayout = class_getIvarLayout(currentClass);</span><br><span class="line">        </span><br><span class="line">        if (ivarLayout) &#123;</span><br><span class="line">            // 找出 Strong 成员变量的位置</span><br><span class="line">            NSMutableIndexSet *interestingIndexes = [NSMutableIndexSet new];</span><br><span class="line">            NSUInteger index = 0;</span><br><span class="line">            while ((*ivarLayout) != '\x00') &#123;</span><br><span class="line">                // 获取高位（高位表示非 Strong 成员变量的个数）及低位（低位表示 Strong 成员变量的个数）</span><br><span class="line">                int upperNibble = (*ivarLayout &amp; 0xf0) &gt;&gt; 4;</span><br><span class="line">                int lowerNibble = *ivarLayout &amp; 0xf;</span><br><span class="line">                </span><br><span class="line">                // 跳过非 Strong 成员变量的个数</span><br><span class="line">                index += upperNibble;</span><br><span class="line">                </span><br><span class="line">                // 保存本次 Strong 成员变量的位置</span><br><span class="line">                [interestingIndexes addIndexesInRange:NSMakeRange(index, lowerNibble)];</span><br><span class="line">                index += lowerNibble;</span><br><span class="line">                </span><br><span class="line">                ++ivarLayout;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            // 获取当前类的成员变量数组</span><br><span class="line">            unsigned int ivarCount;</span><br><span class="line">            Ivar *ivars = class_copyIvarList(currentClass, (&amp;ivarCount));</span><br><span class="line">            </span><br><span class="line">            // 遍历本类中的所有成员变量，保存位置在 interestingIndexes 中的成员变量</span><br><span class="line">            for (NSUInteger i = 0; i &lt; ivarCount; ++i) &#123;</span><br><span class="line">                if ([interestingIndexes containsIndex:i]) &#123;</span><br><span class="line">                    Ivar ivar = ivars[i];</span><br><span class="line">                    </span><br><span class="line">                    // 此处为简单化，直接把 Ivar 数据结构 NSValue 化，也可以创建一个表示 Ivar 的类</span><br><span class="line">                    NSValue *ivarValue = [NSValue value:&amp;ivar withObjCType:@encode(Ivar)];</span><br><span class="line">                    [strongIvars addObject:ivarValue];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        previousClass = currentClass;</span><br><span class="line">        currentClass = class_getSuperclass(currentClass);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    return [strongIvars copy];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我写的这个方法做了一些简化，完整的代码在 <code>FBClassStrongLayout.m</code> 中，感兴趣的可以看看。</p>
<hr>
<p>下篇博客再介绍一下获取 Block 对象的强引用对象的原理。</p>

          
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/blog/2016/04/19/Reading-for-March-2016/" itemprop="url">
                  16年3月读书一本（《把时间当作朋友》）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-04-19T10:59:14+08:00" content="2016-04-19">
              2016-04-19
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/读书/" itemprop="url" rel="index">
                    <span itemprop="name">读书</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/blog/2016/04/19/Reading-for-March-2016/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="/blog/2016/04/19/Reading-for-March-2016/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="《把时间当作朋友》★★★★☆"><a href="#《把时间当作朋友》★★★★☆" class="headerlink" title="《把时间当作朋友》★★★★☆"></a>《把时间当作朋友》★★★★☆</h2><p><img src="http://pic.zhenby.com/Take-time-as-a-friend.jpg" alt="李笑来 著"></p>
<blockquote>
<p>我们听过无数的道理，却仍旧过不好这一生。   ——电影《后会无期》</p>
</blockquote>
<p>我在看这本书的时候，脑海中常常想起这句台词，这本书里面讲了很多我们本来就懂的道理，比如坚持不停的学习就能有所成就；改变你的态度，你就会发现你的世界会因此发生转变。道理很多人都懂，但是能坚持做到的却是少数。我其中三点的收获如下：</p>
<h3 id="开启心智"><a href="#开启心智" class="headerlink" title="开启心智"></a>开启心智</h3><p>开启心智的过程，我的理解就是把自己抽离出来，飞到空中，以上帝视角理性的看待审视你自己所做的事情，从这个角度俯视看，你能看到自己很多的问题，比如：</p>
<ul>
<li>这一天的工作/学习效率如何？都浪费了多少时间？</li>
<li>哪些原因导致了时间的浪费？大脑活跃导致的注意力不集中？希望自己的欲望马上能获得满足？</li>
<li>做这件进度已经 5% 的事情为什么今天会放弃了？是因为回避困难？</li>
<li>……</li>
</ul>
<p>当从这样的角度来思考自己一天的行为时，会发现在整个思考过程中，可以做到忽略了自己情绪的影响，忽略了我们人天性里面的很多缺点，而很理性的看待问题，改进，从而变成大脑的主人。</p>
<h3 id="了解学习的过程"><a href="#了解学习的过程" class="headerlink" title="了解学习的过程"></a>了解学习的过程</h3><p>学习的时候，进展和时间之间的关系可以肯定不是线性的，有的时候，这两者的恭喜是一个先缓慢上升，再高速上升，然后再变成缓慢上升的曲线；有时候，则是一个先缓慢上升，再缓慢下降，再高速上升的曲线……</p>
<blockquote>
<p>你看到了，在任何一个阶段，总是有一段时间进展缓慢，许久过后，所谓量变到质变的效果才会出现，才可能有突飞猛进的感觉。可是人们往往在行进一小段时间之后，就因为觉得进展“过分”缓慢而产生动摇。所以，从来都没有体会过突飞猛进的感觉。然而这样慢慢动摇直至最终放弃的人，在漫长的一生中总是会遇到身边的某些人在“突飞猛进”——于是，在不愿意承认自己曾经的错误的情况下，当然貌似“最合理”的解释就是“呀，他肯定有什么诀窍！”当然，更多的时候，那个曲线应该是一个螺旋上升的曲线。打个比方，就有点儿像华尔兹那样，先进两步再退一步。</p>
<p>如果，你把时间和进展之间的关系仅仅理解为纯粹的线性关系，那你最终根本不可能遇到你所满意的进展。其实，没有哪个人可以长时间忍受失望。这样看来，你曾经的放弃，往往并不是因为你没有毅力， 而只是对时间和进展之间的关系理解错误造成的——在频繁发生失望甚至绝望的情况下你居然坚持了那么久，你其实是多么的有毅力啊！</p>
</blockquote>
<h3 id="人都能力有限，他们光彩，只因准备"><a href="#人都能力有限，他们光彩，只因准备" class="headerlink" title="人都能力有限，他们光彩，只因准备"></a>人都能力有限，他们光彩，只因准备</h3><p>三四年前，我在 UC 的时候，参加一次训练营的活动，活动上的导师是当时 UC 的总裁俞永福，有一个同事问了他一个问题：「为什么问你的很多问题，你都能很快，并且很好的回答？有什么秘诀吗？」，俞永福回答说：「其实问我的很多问题，以前就有人问过我很多次了，或者那个问题我已经在脑海中思考过很久了，所以我才能很快的回答。所以没什么秘诀，只是因为有提前的准备。」（只能记清大意）。<br>哦，原来就是这么简单啊，并没有什么高大上的秘诀，他们的光彩，背后都是因为花了长时间的准备。</p>
<blockquote>
<p>之所以可以“显得”游刃有余，是因为之前做过太多的准备。之所以做那么多的准备，就是因为曾经出过丑——想象一下，在台上突然发现自己说的某句话竟然有不曾想到过的歧义，是多么窘迫的事情？所以，在准备任何一个讲演的时候，我都花费很多的时间认真考虑自己的每个观点，每个事例，甚至每个句子可能引发什么样的理解和反应，然后逐一制定相应对策，才可以心安理得地上台讲演。</p>
</blockquote>
<hr>
<p>看完我这篇读后感的你，我说的这些道理，能让你过好这一生吗？</p>

          
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/blog/2016/03/10/Reading-for-February-2016/" itemprop="url">
                  16年2月读书两本（《创业维艰》《东方快车谋杀案》）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-03-10T23:44:32+08:00" content="2016-03-10">
              2016-03-10
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/读书/" itemprop="url" rel="index">
                    <span itemprop="name">读书</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/blog/2016/03/10/Reading-for-February-2016/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="/blog/2016/03/10/Reading-for-February-2016/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="《创业维艰》★★★★☆"><a href="#《创业维艰》★★★★☆" class="headerlink" title="《创业维艰》★★★★☆"></a>《创业维艰》★★★★☆</h2><p><img src="http://pic.zhenby.com/Hard-Things.jpg" alt="本·霍洛维茨 著，杨晓红/钟莉婷 译"></p>
<p>不错的书，虽然题目是创业相关的，但是里面的很多方法无论在大公司，还是小公司，都是通用的。</p>
<p>印象最深刻的是关于<strong>一对一面谈</strong>的，在看这本书之前，我跟组员面谈时都比较发散，并且对于一些话比较少的人，缺乏科学的引导，最后都变成了大部分时间都是我在说。作者在书里面总结了<strong>一对一面谈</strong>的一些要点跟方法，可操作性很强。</p>
<ul>
<li>一定要明白一点：这是以员工为中心的会谈，不是以上司为中心。它不拘于形式，目的是解决迫在眉睫的问题、交流精彩绝伦的想法，或者倾诉郁结已久的焦虑。这些话题往往不适合通过工作报告、电子邮件或者其他非私人话的途经开展。</li>
<li>会谈时，上司要少说多听。现在，好多公司的「一对一面谈」往往上司说得多，听得少，刚好颠倒了。</li>
<li>有必要引导员工表达他的核心观点。这一点在面对性格内向的员工时显得尤为重要。</li>
<li>以下是有助于引导对方表达想法的一些话题：<ul>
<li>如果我们还有进步的空间，那你认为该从哪方面着手？</li>
<li>你所在部门的最大问题是什么？为什么？</li>
<li>在这里的工作中，哪一点令你感到不愉快？</li>
<li>公司里谁最优秀？你最佩服谁？</li>
<li>假如你是我，你会做何调整？</li>
<li>你这个产品的哪个方面不尽如人意？</li>
<li>你觉得我们错失的最大机遇是什么？</li>
<li>哪些是我们该做而没有做的？</li>
<li>你对这里的工作满意吗？</li>
</ul>
</li>
</ul>
<p>下面是我的<strong>读书笔记</strong>：</p>
<ul>
<li>在团队面前，报喜不报忧，是很蠢的，团队里面的人很清楚现实并没有你描述的那么美好，负面影响也可以激励人。</li>
<li>不要以为你是唯一一个可以为公司解决问题的，所以把所有的问题都揽在自己身上，把问题分配出去，交给有能力，有兴趣，有动力的人去解决，这样才能解决的好。</li>
<li>裁员的时候承认失败，而不是把问题推给员工。承认失败很了不起：「公司经营不善，为了继续发展，我们不得不忍痛辞掉一些优秀的员工」。走的人固然要聊，但是留下的人还要安抚，CEO 必须为管理者们解释裁员的合理性，向全公司通报总体情况。</li>
<li>关于培训员工，大多数管理者似乎都觉得，培训员工这件事应该让其他人来做，但我却坚信，管理者应该亲自来做这件事，这样才能把你的期望，为什么有这样的期望传递下去。有些人觉的实施培训项目会花费太多时间，你要记住，在提升公司生产力方面，其他任何的投入都比不上培训。因此，因为太忙而没时间开展培训就相当于因为太饿而吃不下任何东西。</li>
<li>看清了雇佣出色员工和背叛珍贵友谊之间的矛盾之后，你就应该将事情公开，告诉员工，你和他现在所属的公司有重要的生意往来，在录用他之前，你必须和他所在公司的 CEO 进行沟通，对他进行背景核查。告诉他，如果他不同意，你会立即中止录用，并对此保密。在录用之前，要和朋友进行交谈，这样才能更好地判断录用他的员工对你们的关系所带来的影响。此外，你还有可能避免用人不当，因为往往有些应聘者在面试中表现极佳，但进入公司之后，表现却不尽如人意。</li>
<li>大公司的主管不一定适合小公司，大公司中的主管，大部分是等事情来，需要他去决策，自然会找到他办公室；而小公司的主管，更多的会主动参与到各个环节中。</li>
<li>管理债务：一山不能容二虎；因某一员工得到了另一工作机会而对其补偿过度；缺乏绩效管理机制或员工反馈机制。这些都是满足短期利益，但是不符合长期利益的。</li>
<li>如果面临两种选择：其一，给每个人发同样的奖金，不犯众怒；其二，极力褒奖业绩突出的员工，惹恼其他员工。有经验的管理者会选择后者。如果面临另外两个选择：其一，撤掉今天一个很受欢迎的项目，因为该项目不在长期计划之内；其二，出于维护人心的目的或为了显得前后一致而保留该项目。有经验的管理者也会选择前者。为什么呢？因为他们曾经为管理债务付出过代价，所以不愿再重蹈覆辙。而好好人管理者会选择后者，不要做好好人管理者。</li>
<li>在面试候选者时，你可以留意他们在这方面的一些微小差别，看看他们在考虑问题时究竟是以“我”为出发点，还是以“团队”为出发点。</li>
<li>劳伦斯·J·彼得博士和雷蒙德·赫尔在 1969 年出版的同名书籍中首次使用了“彼得定律”这个术语，意即在一个集团中，员工只要表现出众，就能获得提拔，直至被提拔到一个他不能胜任的岗位（即他们的不称职级别），自此无法再获得提升。安迪·格鲁夫在其管理学经典《格鲁夫给经理人的第一课》中指出，“彼得定律”不可规避，因为我们无从预知某个人的能力会在权利阶梯的哪一层止步。</li>
<li>“坏榜样法则”：一个团队内部无论哪个层面出现了滥竽充数的人，他们都会像蛀虫一样影响其他成员，最终使得能力出众的人也渐趋平庸。这条法则的原理就是：员工会拿他们上级中能力最差的那个人做参照物。举个例子，如果贾斯珀是几个副总裁中最平庸的一个，那么所有的部门主管都会以他为标准，提出升职的要求。</li>
</ul>
<h2 id="《东方快车谋杀案》★★★☆☆"><a href="#《东方快车谋杀案》★★★☆☆" class="headerlink" title="《东方快车谋杀案》★★★☆☆"></a>《东方快车谋杀案》★★★☆☆</h2><p><img src="http://pic.zhenby.com/Murder-on-the-Orient-Express.jpg" alt="阿加莎·克里斯蒂 著，郑桥 译"></p>
<p>信息量太多，我是过年期间碎片时间看完的，导致代入感比较少，结局奇妙，但是没特别震撼。</p>

          
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/blog/2016/02/23/Reading-for-January-2016/" itemprop="url">
                  16年1月读书两本（《彷徨之刃》《岛上书店》）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-02-23T13:42:00+08:00" content="2016-02-23">
              2016-02-23
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/读书/" itemprop="url" rel="index">
                    <span itemprop="name">读书</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/blog/2016/02/23/Reading-for-January-2016/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="/blog/2016/02/23/Reading-for-January-2016/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="《彷徨之刃》★★★★☆"><a href="#《彷徨之刃》★★★★☆" class="headerlink" title="《彷徨之刃》★★★★☆"></a>《彷徨之刃》★★★★☆</h2><p><img src="http://pic.zhenby.com/The-Hovering-Blade.jpg" alt="东野圭吾 著，刘珮瑄 译"></p>
<p>一个未成年人犯罪，而因为日本司法制度对于未成年人犯罪的宽容，受害者的父亲选择自己制裁凶手的故事。</p>
<p>对待未成年人的犯罪，日本司法制度上异常宽容：不会被公布姓名，刑期很短，案子也不会被公开审理。这是从凶手的角度上去考虑，考虑到他们心智还不成熟，给他们较轻的处罚，从而让他们在接下来漫长的人生历程中有机会改正，重新做一个对社会有用的人。而从受害者的角度考虑，很明显，凶手是没得到应有的惩罚的。<br>而社会背景则是大部分人，对案子无动于衷，顶多是可怜一下受害者；媒体为了博眼球，大势宣传，消费这个悲惨故事；邻居把这个故事作为茶余饭后八卦的话题；只有受害者，忍受着失去女儿的痛苦。</p>
<p>查了一下相关的资料：<a href="http://www.nippon.com/hk/features/h00105/?pnum=1" target="_blank" rel="external">川崎市國中一年級學生被殺，修改《少年法》呼聲再度高漲</a>，日本到现在还是是有发生类似的事件，每次发生这样的事件，修改《少年法》的呼声就会出现。法律的条文也在不断的修正，现在的法律制度不是完全公正正义的。所谓的真正公正正义到底是什么？世界都在寻找答案。</p>
<h2 id="《岛上书店》★★★★☆"><a href="#《岛上书店》★★★★☆" class="headerlink" title="《岛上书店》★★★★☆"></a>《岛上书店》★★★★☆</h2><p><img src="http://pic.zhenby.com/The-Storied-Life-of-A.J.Fikry.jpg" alt="加布瑞埃拉·泽文 著，孙仲旭/李玉瑶 译"></p>

          
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/blog/2016/01/23/-Reading-for-December-2015/" itemprop="url">
                  15年12月读书两本（《追风筝的人》《人类简史-从动物到上帝》）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-01-23T20:21:00+08:00" content="2016-01-23">
              2016-01-23
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/读书/" itemprop="url" rel="index">
                    <span itemprop="name">读书</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/blog/2016/01/23/-Reading-for-December-2015/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="/blog/2016/01/23/-Reading-for-December-2015/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="《追风筝的人》★★★★★"><a href="#《追风筝的人》★★★★★" class="headerlink" title="《追风筝的人》★★★★★"></a>《追风筝的人》★★★★★</h2><p><img src="http://pic.zhenby.com/The-Kite-Runner.jpg" alt="卡勒德·胡赛尼 著，李继宏 译"></p>
<p>这是一本关于<strong>友谊</strong>、<strong>等级</strong>、<strong>救赎</strong>及<strong>战争</strong>的故事。</p>
<p>关于<strong>战争</strong>，阿米尔跟他爸之前平静的生活，被战争彻底改变，远离家乡，融入美国，而家乡已经变成一片废墟，生灵涂炭，让人不寒而栗。而现在 ISIS 在中东造成的破坏，不比那时的塔利班轻，这些以宗教的名义，迫害普通老百姓的行径真让人不齿。人民无力改变，感到绝望，更可怕的是，小孩从小在这样的环境下长大，接受极端思想的教育，对世界充满仇恨，这些现在是 ISIS 统治地区人民的日常，想想都觉的很可怕。</p>
<h2 id="《人类简史-从动物到上帝》★★★★★"><a href="#《人类简史-从动物到上帝》★★★★★" class="headerlink" title="《人类简史-从动物到上帝》★★★★★"></a>《人类简史-从动物到上帝》★★★★★</h2><p><img src="http://pic.zhenby.com/Brief-History-Humankind.jpg" alt="尤瓦尔·赫拉利 著，林俊宏 译"></p>
<p>这本书讲述了：把时间跨度拉长，看人类是怎么从猿人，到智人，再经历认知革命，农业革命，科学革命走到今天统治世界的地位的。在讲述的过程中，有很多有意思的观点：</p>
<ul>
<li><p>智人这一分支打败其他分支的人种，开始统治世界。而让智人脱颖而出的是<strong>语言</strong>及<strong>想象力</strong>。人类语言比其他动物的语言更丰富更多样，也有说因为智人要交流八卦，所以需要很多语言上的交流，从而让他们脱颖而出；而想象力则是智人特有的，通过想象出一些现实世界中不存在的东西，并且还能让别人相信，从而有共同的立场，这就是宗教、国家、公司的前身。</p>
</li>
<li><p>智人所到之处，当地的很多物种就开始<strong>灭亡</strong>，特别是大型动物，作者没有一口咬定就是智人导致了这些物种的灭亡，但是通过对比智人到达一个地方的时间以及该地方的大型动物开始灭亡的时间来看，基本可以确定跟智人是有很大关系的。智人每去到一个地方，会对当地的资源进行采集，一开始当地物种觉得智人根本没什么威胁，而事实上智人的智力已经甩它们几条街了，可以通过火、团队作战、陷阱等方式轻松打猎。而等到这些物种身上将要进化出怕智人的基因时，它们已经灭绝。</p>
</li>
<li><p>人类在农业革命后，陷入了<strong>虚荣陷阱</strong>，以为会过得越来越轻松，事实上，人类在农业革命后过的比农业革命前还惨，因为安定聚集起来了，人口上去了，一旦粮食欠收就会导致饥饿，人群聚集使传染病更容易传播，农活也限制了人类的活动范围。</p>
</li>
<li><p>书中说了另一种<strong>农业革命</strong>发生的可能：因为<strong>宗教的原因</strong>，需要在某个圣地建宏伟的建筑，从而需要做大量的集中体力活，导致人类聚集，然后驯化了小麦，人类也因为虔诚而聚集在宗教点附近。</p>
</li>
<li><p>从<strong>动植物的角度看农业革命</strong>，就很惨了，羊牛鸡鸭命运都很曲折，有得要一直怀孕挤奶，有得刚生出来不久就要被杀做成食物，有得要一直做苦力活。</p>
</li>
<li><p>讲到<strong>不公平</strong>产生的原因，是因为<strong>历史偶然事件</strong>的发生，让白人，雅利安人占据了领导地位。而为了巩固他们的统治，握有权利的他们，可以结合社会各方面（宗教、身体结构、智力等）对黑人，印度人产生歧视，从而让他们自己的地位高人一等，让黑人，印度人地位低的可怜。一旦社会地位低，向上的机会就会减少，而社会又会拿「黑人、印度人很少从事某个职位」这种观点来证明他们是低人一级的，这是一个恶性循环。</p>
</li>
<li><p>什么行为是自然的，什么行为是不自然的？在人类的大部分阶段，异性之间的性行为是自然的，同性之间的性行为是不自然的，这个自然与不自然的划分，是文化造成的，「<strong>天生带来允许，文化造成封闭</strong>」。人类的一些器官如果都按「自然」的方式使用，那亲吻也是不自然的，因为嘴巴生来是吃东西的。</p>
</li>
<li><p>科学革命，1860 年代的世界，西方已因为科学革命上升了一个维度，打中国绰绰有余。而科学革命的前提，是<strong>承认自己的无知</strong>，<strong>放下身段</strong>，<strong>才能去探索</strong>。资本主义与科学是现代社会的基石。</p>
</li>
</ul>

          
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/blog/2015/12/12/-Reading-for-November-2015/" itemprop="url">
                  15年11月读书三本（《天才在左，疯子在右》《秘密》《蒋介石传》）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-12-12T12:20:00+08:00" content="2015-12-12">
              2015-12-12
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/读书/" itemprop="url" rel="index">
                    <span itemprop="name">读书</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/blog/2015/12/12/-Reading-for-November-2015/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="/blog/2015/12/12/-Reading-for-November-2015/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="《天才在左，疯子在右》★★★☆☆"><a href="#《天才在左，疯子在右》★★★☆☆" class="headerlink" title="《天才在左，疯子在右》★★★☆☆"></a>《天才在左，疯子在右》★★★☆☆</h2><p><img src="http://pic.zhenby.com/tiancai.png" alt="高铭 著"></p>
<p>这书一直躺在我的书单里，上次同事极力推荐，就买了电子书看。一开始看挺震撼的，一群在我们世俗眼光下不正常的人，一个个却都有一些很特别的世界观，让你换个角度去看世界，觉的一切很新鲜。</p>
<p>里面有各种大开脑洞的想法，有觉得石头是一种生命，观察石头很久不动是因为我们的时间对于石头来说只是很少的瞬间；蚂蚁群是生命，蚂蚁只是细胞；里面住着三个多重人格的人，三个人格被杀剩一个；觉得自己是一本小说主角，你只是他小说中的一个人物的男人；与四维生物交流，我们在四维生物眼中都是一条虫子，时间是虫子的长度，从一个时间点开始，从另一个时间点结束，就是虫子；还有对宗教虔诚到极点，到走火入魔，变成信仰魔鬼，从而衬托出神的伟大的男人。</p>
<p>最喜欢的一节是说玛雅文明的，探索一种未知文字可先从数字入手，看哪些字是表达一、二、三这些数字的，然后再看数字前后跟的名词，然后再推测。而玛雅文明的特点是文字描述很简单，重视祭祀，现实中没有车轮，却有车轮祭品，对天文很在行。作者推断玛雅文明之前是有一个上层文明的，可能来至宇宙，这样部分疑惑就比较容易解释了。</p>
<p>本来觉的这书挺不错的，但是读到最后，竟然看到「这里有近 20 余篇是真实案例；也有些是出于一些原因，我基于真实案例在内容赏做了增添或者删减」，我感觉被欺骗了，这本书的副标题明明叫：国内第一本精神病人访谈手记。</p>
<h2 id="《秘密》★★★★★"><a href="#《秘密》★★★★★" class="headerlink" title="《秘密》★★★★★"></a>《秘密》★★★★★</h2><p><img src="http://pic.zhenby.com/secret.png" alt="东野圭吾 著"></p>
<p>很好的一本小说，结尾很震惊。东野圭吾的小说一旦开始读，总是放不下手。</p>
<p>车祸，母亲死了，女儿重伤，最后发现母亲的灵魂交换到女儿身上，父亲开始与女儿身，妈妈魂的一个人相依为命；想象这情景套到自己身上，也是非常棘手。<br>一老一少，生活还得继续，<br>老的要上班，少的要上学，<br>老的生活枯燥乏味，少的生活多姿多彩。<br>老的终究要被青春抛弃。</p>
<h2 id="《蒋介石传》-★★★☆☆"><a href="#《蒋介石传》-★★★☆☆" class="headerlink" title="《蒋介石传》 ★★★☆☆"></a>《蒋介石传》 ★★★☆☆</h2><p><img src="http://pic.zhenby.com/Chiang-Kai-shek.png" alt="布赖恩·克罗泽 著"></p>
<p>书一般，基本是一本蒋的大事记。</p>
<p>我们用现在的眼光去看历史，总是马后炮的说：这选择是错的，应该这样这样做，仿佛按照我们的想法做，历史就能按照我们预想的发展。我在看这书的时候就多次有这样的想法，比如九一八时蒋介石让张学良不抵抗，再比如西安事变后，张学良被软禁，而国共内战期间，蒋介石不愿意把张学良放回东北战场…</p>
<p>我们无法亲身体会的感受到人物当时面临的众多选择，更多的是应该理解人物当时的选择。</p>

          
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/blog/2013/10/10/blink-support-ios-7-now/" itemprop="url">
                  BLink V1.5 兼容iOS 7了
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2013-10-10T17:25:00+08:00" content="2013-10-10">
              2013-10-10
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/作品/" itemprop="url" rel="index">
                    <span itemprop="name">作品</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/blog/2013/10/10/blink-support-ios-7-now/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="/blog/2013/10/10/blink-support-ios-7-now/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="http://pic.zhenby.com/BLink-iOS7.png" alt="BLink in iOS 7">  </p>
<h2 id="之前为什么不兼容-iOS-7"><a href="#之前为什么不兼容-iOS-7" class="headerlink" title="之前为什么不兼容 iOS 7"></a>之前为什么不兼容 iOS 7</h2><p>我在上一篇博客<a href="http://zhenby.com/blog/2013/09/12/blink/">第一个收费应用-BLink</a>中提到过，BLink 不兼容 iOS 7 是因为 iOS 7 的 bug，那时候因为 iOS 7 还在测试阶段，因为 NDA 的原因，我没细说那个 bug：  </p>
<blockquote>
<p>在 iOS 7 中，在 Web App 的全屏模式下（standlone），所有会离开当前浏览会话的 JS 执行都无效。比如，在全屏模式下，执行一个 JS 的 alert 语句无效，使用 JS 打开一个应用的 URL Scheme 也会无效。  </p>
</blockquote>
<p>因为 BLink 的快捷方式实际上就是一个桌面书签，会通过是否全屏模式做不同的操作：非全屏模式下，提示用户添加书签到桌面上；全屏模式下，直接打开一个 URL Scheme。<br>因为 iOS 7 的这个 bug，在全屏模式下打开一个应用的 URL Scheme 无效了，所以 BLink 在 iOS 7 下的快捷方式打开后只会是一个白屏。  </p>
<h2 id="别对苹果修-bug-抱太大希望，要有-Plan-B"><a href="#别对苹果修-bug-抱太大希望，要有-Plan-B" class="headerlink" title="别对苹果修 bug 抱太大希望，要有 Plan B"></a>别对苹果修 bug 抱太大希望，要有 Plan B</h2><p>这个 bug 从 iOS 7 测试版本就一直存在，具体从 beta 几开始我没测试，我从 iOS 7 beta 4 开始试用 iOS 7，就发现了这个 bug，我一直认为现在是 iOS 7 的测试版本，有 bug 很正常，看到苹果开发者论坛上也有人已经报 bug 给苹果了，所以我是幻想着苹果能在 iOS 7 正式版本之前解决这个 bug 的。<br>但是到了 beta 6，再到9月10号苹果发布会后发布的 GM版，这个 bug 还是一直存在。<br>我这个时候还是幻想着苹果能在正式版的时候解决这个 bug，毕竟这是个大问题阿，所有全屏 Web App 都会受影响，连 alert 都 alert 不了。<br>所以在这段 iOS 7 测试版本期间，我没有做任何的行动，也没想好一直幻想着正式版本能正常工作。<br>但是在9月18号的时候，iOS 7 正式版发布，我测试后，问题依旧阿。我X，而且发现正式版根本就是 GM 版，一个星期一个问题都没解决阿，顿时对苹果失望至极。  </p>
<p>因为之前对苹果修 bug 抱太大希望，我根本没考虑 Plan B，所以正式版发布后，一天几个一星差评，几封反馈的邮件。<br>这是教训阿，以后对这种大版本的更新，在最后的 GM 版本，如果还有问题，就应该尽快想 Plan B，并尽快上线新版本，并且，再加根据系统版本的远程开关，这样即使正式版本修复了，也可以远程控制是否启用 Plan B。  </p>
<h2 id="怎么解决的"><a href="#怎么解决的" class="headerlink" title="怎么解决的"></a>怎么解决的</h2><p>解决的过程比较曲折，我尝试了使用 Local Storage 以及 Web SQL Database 来保存「是否将快捷方式添加到桌面」的标识，由于我的快捷方式的书签地址为 data:text/html 类型的，都无法使用 Local Storeage 及 Web SQL Database。<br>一开始一筹莫展，想不到好的办法解决，最后参考了一个同类型的 App，他们是使用安装「描述文件」的方式来生成桌面快捷方式。这种方式我一开始是抗拒的，因为用户不了解什么是描述文件，也不确定安装完后会不会对设备造成其他影响，而且由于我没买电子签名证书，所以我生成的描述文件在设备上安装时，会显示「未签名」的，这也会让用户疑惑。但是实在找不到其他的解决办法，最后只能在安装过程中提示用户「安装此描述文件只会在你的设备主屏幕上添加一个快捷方式，不会修改你设备上的任何设置，所以无需担心描述文件未签名的问题。」  </p>
<p><img src="http://pic.zhenby.com/Profile.png" alt="Install the Profile">  </p>
<p>然后，解决了这个问题后，我又发现了一个 bug，在 iOS 7 中，从原生的应用中尝试打开电话的 URL Scheme 时，会卡个10秒，拨号的界面才会出现，电话已经拨通了，但是界面却一直卡在打开的原生应用中。<br>这是恶心的问题阿，最后只能直接通过 Safari 打开电话的 URL Scheme，这就导致了每次都会出现一个确认框，用户体验又下降一大截了。  </p>
<p><img src="http://pic.zhenby.com/Confim.png" alt="Confirmation box">  </p>
<p>所以在 iOS 7 中，现在的 BLink 只能算个半成品，只是达到勉强可用的状态，希望苹果尽快发布新的 iOS 7 版本，可能修复这些 bug。  </p>
<h2 id="感受"><a href="#感受" class="headerlink" title="感受"></a>感受</h2><p>这件事后，我思考了一下，为什么 BLink 会遇到这样的窘境，我发现是因为 BLink 太依赖 iOS 中原生的其他应用了，整个应用流程不能在 BLink 里面单独完成，在 BLink 中完成一部分操作，跳出 BLink，再在其他地方完成另一部分操作。而依赖越多，那么限制也会越多，毕竟依赖的这部分你是无法控制的。<br>所以我的下个应用，我希望能做一个独立的，拥有完整用户体验的一个应用。  </p>

          
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/blog/2013/09/12/blink/" itemprop="url">
                  第一个收费App——BLink
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2013-09-12T20:24:00+08:00" content="2013-09-12">
              2013-09-12
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/作品/" itemprop="url" rel="index">
                    <span itemprop="name">作品</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/blog/2013/09/12/blink/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="/blog/2013/09/12/blink/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近新上架了第一个收费作品：<a href="https://itunes.apple.com/us/app/blink-contact-shortcuts-contact/id684640621?ls=1&amp;mt=8" target="_blank" rel="external">BLink</a>  </p>
<p><img src="http://pic.zhenby.com/BLink-Screenshot-1.png" alt="BLink 0"><img src="http://pic.zhenby.com/BLink-Screenshot-2.png" alt="BLink 1"></p>
<h2 id="做什么的"><a href="#做什么的" class="headerlink" title="做什么的"></a>做什么的</h2><p>这是一个用来创建联系人快捷方式的 App，用户可以用照片，或者内置的头像在桌面上创建一个用于打电话、发短信、发邮件的快捷图标。  </p>
<h2 id="原理很简单"><a href="#原理很简单" class="headerlink" title="原理很简单"></a>原理很简单</h2><p>如果大家用过 BLink 的话，就会知道它的工作原理还是很简单的，生成图标必须依靠 Safari，所以每个快捷方式其实就是一个 Web Clip，判断到是全屏启动的，则直接跳转到一个 URL Scheme。  </p>
<h2 id="限免"><a href="#限免" class="headerlink" title="限免"></a>限免</h2><p>由于是第一个收费作品，所以没经验，早上六点多审核通过上线的，中午十二点我就把他设置成限免了，后来 bang 提醒我，设置的太快了，收费的时间太短，这样限免的网站爬不到价格变化，就不会推荐了。</p>
<p>果然，我搜了又搜，限免网站上都找不到推荐，只能自己在<a href="http://www.iapps.im/single/16644" target="_blank" rel="external">爱应用</a>上自推了一下，编辑觉的不错，就推荐了。其他中文网站看到后，也做了不少推荐，所以量还不错。但是都是大中华地区的，我本来定位的主要付费市场是在欧美的，由于限免时机设置的不好，欧美的量少的可怜。  </p>
<p>所以第一次上线的时候，可以收费几天，然后再设置限免，这样限免的效果比较好。如果本来已经有收费版本上线了，只是更新版本而已，那审核通过后，可以马上设置成限免。  </p>
<p>收费后，BLink 最高的时候冲到了中国区付费总榜单的第30名左右。第二天出销售报告的时候才知道，付费总榜单第30名的钱也没多少钱，单靠这点钱，那些主要市场在中国区的付费应用的公司真没法活。  </p>
<h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><h3 id="不兼容-iOS-7"><a href="#不兼容-iOS-7" class="headerlink" title="不兼容 iOS 7"></a>不兼容 iOS 7</h3><p>由于 iOS 7 当前的测试版本有 bug，BLink 创建的快捷方式在 iOS 7 上打开后，一片空白，不能打电话，也不能调出发信息、发邮件的界面。因为这个 bug，中国区的用户有几个上来就直接给一星，写说不能兼容 iOS 7，中国区的用户就喜欢尝鲜啊。<br>对于这个 bug，我试了几种办法，都不能规避它，只能让苹果解决了，已经有国外开发者把这个 bug 提交给苹果了(<a href="https://devforums.apple.com/message/885521#885521" target="_blank" rel="external">Apple Developer 论坛对此 bug 的讨论</a>)，但是在苹果发布会上发布的 iOS 7 GM 版本上，此 bug 依然存在。希望18号发布的 iOS 7 正式版能解决此问题。  </p>
<h3 id="快捷方式启动慢"><a href="#快捷方式启动慢" class="headerlink" title="快捷方式启动慢"></a>快捷方式启动慢</h3><p>这个问题我只能尽量的优化，因为是使用 Web Clip 作为快捷方式的，所以快捷方式启动的快慢主要取决于 Web Clip 的加载速度，其他耗时的过程，包括从 Safari 切换到具体应用，具体应用的打开，我不能干预。所以我能做的，只能是缩小 Web Clip 的体积。测试了一天，终于大大缩小了 Web Clip 的体积。优化后的版本为 V1.1 版本，很快就能上线。   </p>

          
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    

  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/default_avatar.jpg"
               alt="zhenby" />
          <p class="site-author-name" itemprop="name">zhenby</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">26</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>
          
          
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">5</span>
                <span class="site-state-item-name">分类</span>
              
            </div>
          

          
            <div class="site-state-item site-state-tags">
              
                <span class="site-state-item-count">23</span>
                <span class="site-state-item-name">标签</span>
              
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        <div class="links-of-author motion-element">
          
        </div>

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">zhenby</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>



      </div>
    </footer>

    <div class="back-to-top"></div>
  </div>

  


  



  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=0.5.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=0.5.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=0.5.0"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"zhenby"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
  





  
  

  
  


</body>
</html>
